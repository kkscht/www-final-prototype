<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- let's import our stylesheet (found in public/css/styles.css)-->
  
    <!-- Bootstrap -->

     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
     integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
 
    <!-- Our style sheet -->
    <link rel="stylesheet" type="text/css" href="/css/styles.css" />

    <!-- Google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cabin:ital,wght@0,400..700;1,400..700&family=Inter:wght@100..900"
    rel="stylesheet">

   <style>
    h1 {
     font-family: "Arial Black";
     text-align: left;
     color: #E91E63;
     -webkit-text-stroke-width: 1px;
    -webkit-text-stroke-color: black;
    }
    </style>
  </head>

  <!-- you can also specify styles straight in html! Let's use Verdana on this page.-->
  <body style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif" >
    <header
      style="background-color: #FBD0DE; padding: 15px; text-align: center"
    >
    

    
      <div class="navbar">
        <h1>Edit Profile</h1>
        <a href="/dashboard.html" class="back-button">&larr; Back</a>
      </div>
    </header>

 
   

      

   
      <div class="content-container">
  
        
        <div
        role="button"
        tabindex="0"
        data-bs-toggle="modal"
        data-bs-target="#profilePicModal"
      >
        <img class="profile-pic" src="/images/default_avatar.png" />
      </div>
   
   
        <!-- This is where the popup modal lives. It won't render until the profile pic is clicked. -->
        <div
        class="modal fade"
        id="profilePicModal"
        tabindex="-1"
        aria-labelledby="profilePicModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <label for="profile-pic-file" class="form-label">
                Choose a new profile picture:
              </label>


              <!-- Add a file uploader component here! -->
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>


<div class="edit-info">
  <form id="profile-form"> 
    <div class="profile-form">
  
    <div class="custom-scroll">

      <label for="photos">Photos 
       
        <img class="edit" role="button"
        tabindex="0"
        data-bs-toggle="modal"
        data-bs-target="#uploadPhotos" src="/images/edit.png" />
   
      </label>
              
  
    
 
 
 
      <!-- This is where the popup modal lives. It won't render until the profile pic is clicked. -->
      <div
      class="modal fade"
      id="uploadPhotos"
      tabindex="-1"
      aria-labelledby="uploadPhotosLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <label >
              Choose new photos:
            </label>
            <input type="file" id="files" name="files" multiple>



            <!-- Add a file uploader component here! -->
          </div>
          <div class="modal-footer">
            <input type="submit">
          </div>

        </div>
      </div>
      
    </div>

    <div class="gallery">
      <div class="gallery-item">
        <img alt="gallery-post" src="/images/bunny.jpg" />
        <span class="media-icon"></span>
      </div>
      <div class="gallery-item">
        <img alt="gallery-post" src="/images/bunny.jpg" />
        <span class="media-icon"></span>
      </div>

    </div>


    <div class="form-group">
      <label for="first-name">First Name</label>
      <input type="text" id="first-name" name="first_name" placeholder="FirstName">
    </div>
    <div class="form-group">
      <label for="last-name">Last Name</label>
      <input type="text" id="last-name" name="last_name" placeholder="LastName">
    </div>
    <div class="form-group">
      <label for="phone-number">Phone Number</label>
      <input type="tel" id="phone-number" name="phone_number" placeholder="+ 123 456 7890">
    </div>
    <div class="form-group">
      <label for="travel-information">Travel Information</label>
      <textarea id="travel-information" name="travel-information" placeholder="Your travel information..."></textarea>
    </div>
    <div class="form-group">
    <div class="form-group">
      <label for="bio">Bio</label>
      <textarea id="bio" name="bio" placeholder="Your bio..."></textarea>
    </div>
    <label for="interests">Languages <a href="languages.html"><img class="edit" src="/images/edit.png"></a></label>
    <section class="languages">
      <div class="tags">
          <span>Lorem</span>
      </div>
      </section>

    <label for="interests">Interests <a href="interests.html"><img class="edit" src="/images/edit.png"></a></label>
    <section class="interests">
      <div class="tags">
          <span>Lorem</span>
      </div>
      </section>

      <label for="travel-style">Travel Style <a href="travel-style.html"><img class="edit" src="/images/edit.png"></a></label>
      <section class="travel-style">
        <div class="tags">
            <span>Lorem</span>
        </div>
        </section>


  </div>
  </div>
</div>
</div>
  <button id="submit" type="submit" class="update-button">Update</button>
  </form>


   
      <script>
        // You can use this function to close the Bootstrap modal.
        const closeModal = () => {
          const modal = document.getElementById("profilePicModal");
          const modalInstance = bootstrap.Modal.getInstance(modal);
          modalInstance.hide();
        };
  
        // This function takes a data URL and resizes it down so it can be stored in localStorage.
        // Loading the image isn't instant, so the function returns a *Promise*.
        // You can use .then() to specify code that should run after the image is resized:
        // resizeAndCropPic(dataUrl).then((croppedDataUrl) => {
        //   // do something with croppedDataUrl
        // });
        // (or use async/await!)
        const resizeAndCropPic = (dataUrl) => {
          // crop to the center and resize to 512x512
          return new Promise((resolve) => {
            const canvas = document.createElement("canvas");
            [canvas.width, canvas.height] = [512, 512];
            const ctx = canvas.getContext("2d");
  
            const img = new Image();
            img.src = dataUrl;
            img.onload = () => {
              const [width, height] = [img.width, img.height];
              const [shorter, longer] =
                width < height ? [width, height] : [height, width];
              const [x, y] =
                width < height
                  ? [0, (height - width) / 2]
                  : [(width - height) / 2, 0];
              ctx.drawImage(img, x, y, shorter, shorter, 0, 0, 512, 512);
              const croppedDataUrl = canvas.toDataURL("image/jpeg");
  
              resolve(croppedDataUrl);
            };
          });
        };
            // Your solution here:
  
            window.onload = () => {
        // Load saved data into the form if it exists, but only set it, not bind any input events here
        const firstName = localStorage.getItem('firstName');
        const lastName = localStorage.getItem('lastName');
        const phoneNumber = localStorage.getItem('phoneNumber');

        const bio = localStorage.getItem('bio');
        const profilePicture = localStorage.getItem('profilePicture');
        
        if (firstName) {
            document.getElementById('first-name').value = firstName;
        }
        if (lastName) {
            document.getElementById('last-name').value = lastName;
        }
        if (phoneNumber) {
            document.getElementById('phone-number').value = phoneNumber;
        }
    
        if (bio) {
            document.getElementById('bio').value = bio;
        }
        

        if (profilePicture) {
            document.querySelector('.profile-pic').src = profilePicture;
        }
    };

    document.querySelector('.modal-body').insertAdjacentHTML('beforeend', `<input type="file" id="profile-pic-file" class="form-control" accept="image/*" />`);

    document.getElementById('profile-pic-file').addEventListener('change', (event) => {
        const file = event.target.files[0];
        const fileReader = new FileReader();
        fileReader.readAsDataURL(file);
        fileReader.onload = (input) => {
            resizeAndCropPic(input.target.result).then((cropped) => {
                // Temporarily display the cropped image in the UI, but don't save it yet
                document.querySelector('.profile-pic').src = cropped;
                // Store in a temporary global variable to save later
                window.tempProfilePic = cropped;
                closeModal();
            });
        };
    });

  
      </script>

      <script>
        var selectedInterests = JSON.parse(localStorage.getItem('selectedInterests')) || [];
        var interestsContainer = document.querySelector('.interests .tags');
        interestsContainer.innerHTML = '';
        selectedInterests.forEach(function(tagValue) {
            var tagSpan = document.createElement('span');
            tagSpan.textContent = tagValue;
            interestsContainer.appendChild(tagSpan);
        });
      </script>

      <script>
      var selectedLanguages = JSON.parse(localStorage.getItem('selectedLanguages')) || [];
      var languagesContainer = document.querySelector('.languages .tags');
      languagesContainer.innerHTML = '';
      selectedLanguages.forEach(function(tagValue) {
      var tagSpan = document.createElement('span');
      tagSpan.textContent = tagValue;
      languagesContainer.appendChild(tagSpan);
      });
      </script>

      <script>
      var selectedTravelStyle = JSON.parse(localStorage.getItem('selectedTravelStyle')) || [];
      var travelStyleContainer = document.querySelector('.travel-style .tags');
      travelStyleContainer.innerHTML = '';
      selectedTravelStyle.forEach(function(tagValue) {
      var tagSpan = document.createElement('span');
      tagSpan.textContent = tagValue;
      travelStyleContainer.appendChild(tagSpan);
      });
      </script>




       

      <script src="script.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

  </body>
 

</html>
