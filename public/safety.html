<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- let's import our stylesheet (found in public/css/styles.css)-->
    
    <!-- Bootstrap -->
    <!-- <link rel="stylesheet" 
    href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" 
    integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
     -->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- Our style sheet -->
    <link rel="stylesheet" type="text/css" href="/css/styles.css" />

     <!-- Google fonts -->
     <link rel="preconnect" href="https://fonts.googleapis.com">
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
     <link href="https://fonts.googleapis.com/css2?family=Cabin:ital,wght@0,400..700;1,400..700&family=Inter:wght@100..900"
     rel="stylesheet">

    <style>
     h1 {
      font-family: "Cabin";
     }

     h2 {
      font-family: "Inter";
     }

     header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
      }

      .home.hidden,
      .btn.hidden {
        display: none;
      }

      .element-blurb {
        background-color: white;
        padding: 2rem;
        box-shadow: 0 0 1rem rgba(0, 0, 0, 0.1);
        display: flex;
        gap: 4rem;
        align-items: center;

        &.hidden {
          display: none;
        }
      }

      #menu-bar {
        display: flex;
        justify-content: space-between;
        padding: 10px;
        /* justify-content: space-between;
        align-items: center; */
      }

      .planet-image {
        flex: 1;
      }

      .section-info{
        flex: 2;
      }
      #location-fetch-header{
        display:flex;
        flex:1 1;
        justify-content: start;
      }

      #dot-loader {
        display: flex;
      
        &.hidden {
          display: none;
        }
      }

      .dot-container {
        display: flex;

        &.hidden {
          display: none;
        }
      }

      .location-loaded {
        display: flex;

        &.hidden {
          display: none;
        }
      }
      .location-pin-icon {
        display: flex;

        &.hidden {
          display: none;
        }
      }

    </style>
    <style>
      /**
      * ==============================================
      * Dot Flashing
      * Credits: https://codepen.io/nzbin/pen/GGrXbp 
      * ==============================================
      */
      .dot-flashing {
        position: relative;
        width: 10px;
        height: 10px;
        border-radius: 5px;
        background-color: #E91E63;
        color: #E91E63;
        animation: dot-flashing 1s infinite linear alternate;
        animation-delay: 0.5s;
        
      }

      .dot-flashing::before, .dot-flashing::after {
        content: "";
        display: inline-block;
        position: absolute;
        top: 0;

      }
      .dot-flashing::before {
        left: -15px;
        width: 10px;
        height: 10px;
        border-radius: 5px;
        background-color: #E91E63;
        color: #E91E63;
        animation: dot-flashing 1s infinite alternate;
        animation-delay: 0s;

      }
      .dot-flashing::after {
        left: 15px;
        width: 10px;
        height: 10px;
        border-radius: 5px;
        background-color: #E91E63;
        color: #E91E63;
        animation: dot-flashing 1s infinite alternate;
        animation-delay: 1s;

      }

      @keyframes dot-flashing {
        0% {
          background-color: #E91E63;
        }
        50%, 100% {
          background-color: rgba(255, 128, 215, 0.2);
        }
      }
      /* Dot Flashing end of styling */
    </style>
      
  </head>

  <!-- you can also specify styles straight in html! Let's use Arial and gray text on this page.-->
  <body style="color: #0f0a0a">
    <header
      style="background-color: #fbd0de; padding: 15px; text-align: center"
    >
      <h1>Safety</h1>
    </header>

    <div class="site-view">
      <nav>
        <!-- <a href="/na-current" class="nav-link"><i class="glyphicon glyphicon-plane"></i><br>Current Trip</a> 
        <a href="/map" class="nav-link"><i class="glyphicon glyphicon-map-marker"></i><br>Map</a>
        <a href="/na" class="nav-link"><i class="	glyphicon glyphicon-globe"></i><br>Discover</a>
        <a href="/safety" class="nav-link"><i class="	glyphicon glyphicon-asterisk"></i><br>Safety</a>
        <a href="/dashboard" class="nav-link"><i class="glyphicon glyphicon-user"></i><br>Dashboard</a> 
      -->

        <a href="/na-current" class="nav-link"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-airplane" viewBox="0 0 16 16">
          <path d="M6.428 1.151C6.708.591 7.213 0 8 0s1.292.592 1.572 1.151C9.861 1.73 10 2.431 10 3v3.691l5.17 2.585a1.5 1.5 0 0 1 .83 1.342V12a.5.5 0 0 1-.582.493l-5.507-.918-.375 2.253 1.318 1.318A.5.5 0 0 1 10.5 16h-5a.5.5 0 0 1-.354-.854l1.319-1.318-.376-2.253-5.507.918A.5.5 0 0 1 0 12v-1.382a1.5 1.5 0 0 1 .83-1.342L6 6.691V3c0-.568.14-1.271.428-1.849m.894.448C7.111 2.02 7 2.569 7 3v4a.5.5 0 0 1-.276.447l-5.448 2.724a.5.5 0 0 0-.276.447v.792l5.418-.903a.5.5 0 0 1 .575.41l.5 3a.5.5 0 0 1-.14.437L6.708 15h2.586l-.647-.646a.5.5 0 0 1-.14-.436l.5-3a.5.5 0 0 1 .576-.411L15 11.41v-.792a.5.5 0 0 0-.276-.447L9.276 7.447A.5.5 0 0 1 9 7V3c0-.432-.11-.979-.322-1.401C8.458 1.159 8.213 1 8 1s-.458.158-.678.599"/>
        </svg><br>Current Trip</a>
        <a href="/map" class="nav-link"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-geo-alt" viewBox="0 0 16 16">
          <path d="M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A32 32 0 0 1 8 14.58a32 32 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10"/>
          <path d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
        </svg><br>Map</a>
        <a href="/na" class="nav-link"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-globe-americas" viewBox="0 0 16 16">
          <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0M2.04 4.326c.325 1.329 2.532 2.54 3.717 3.19.48.263.793.434.743.484q-.121.12-.242.234c-.416.396-.787.749-.758 1.266.035.634.618.824 1.214 1.017.577.188 1.168.38 1.286.983.082.417-.075.988-.22 1.52-.215.782-.406 1.48.22 1.48 1.5-.5 3.798-3.186 4-5 .138-1.243-2-2-3.5-2.5-.478-.16-.755.081-.99.284-.172.15-.322.279-.51.216-.445-.148-2.5-2-1.5-2.5.78-.39.952-.171 1.227.182.078.099.163.208.273.318.609.304.662-.132.723-.633.039-.322.081-.671.277-.867.434-.434 1.265-.791 2.028-1.12.712-.306 1.365-.587 1.579-.88A7 7 0 1 1 2.04 4.327Z"/>
        </svg><br>Discover</a>
        <a href="/safety" class="nav-link"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-file-medical" viewBox="0 0 16 16">
          <path d="M8.5 4.5a.5.5 0 0 0-1 0v.634l-.549-.317a.5.5 0 1 0-.5.866L7 6l-.549.317a.5.5 0 1 0 .5.866l.549-.317V7.5a.5.5 0 1 0 1 0v-.634l.549.317a.5.5 0 1 0 .5-.866L9 6l.549-.317a.5.5 0 1 0-.5-.866l-.549.317zM5.5 9a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1z"/>
          <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"/>
        </svg><br>Safety</a>
        <a href="/dashboard" class="nav-link"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
          <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"></path>
        </svg></i><br>Dashboard</a>
      </nav>
      
        <div id="menu-bar">
          <div id="location-fetch-header">
            
            <div id="dot-loader" class="dot-container" style="padding-left: 30px;padding-top: 9px;">
              <div class="dot-flashing"></div>
            </div>
            <div id="location-display" class="location-loaded hidden" style="padding:1px">
              <!-- <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-geo" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6M4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999zm2.493 8.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.3 1.3 0 0 0-.37.265.3.3 0 0 0-.057.09V14l.002.008.016.033a.6.6 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.6.6 0 0 0 .146-.15l.015-.033L12 14v-.004a.3.3 0 0 0-.057-.09 1.3 1.3 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465s-2.462-.172-3.34-.465c-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411"/>
              </svg> -->
              <div id="location-text" class="location-loaded" style="padding-left: 40px;"></div>
            </div>

          </div>
          <button class="btn btn-secondary hidden" id="home-button" style="padding: 5px">Back</button>
        </div>


        <div id="home-page" class="home">
        
          <div class="card mb-3" role="button" id="emergency-numbers-button">
            <div class="row g-0">
              <div class="col-md-4" style="padding:20px">
                <!-- add container-defining element here -->
                <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="currentColor" class="bi bi-hospital" viewBox="0 0 16 16">
                  <path d="M8.5 5.034v1.1l.953-.55.5.867L9 7l.953.55-.5.866-.953-.55v1.1h-1v-1.1l-.953.55-.5-.866L7 7l-.953-.55.5-.866.953.55v-1.1zM13.25 9a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25zM13 11.25a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25zm.25 1.75a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25zm-11-4a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5A.25.25 0 0 0 3 9.75v-.5A.25.25 0 0 0 2.75 9zm0 2a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25zM2 13.25a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25z"/>
                  <path d="M5 1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v1a1 1 0 0 1 1 1v4h3a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1h3V3a1 1 0 0 1 1-1zm2 14h2v-3H7zm3 0h1V3H5v12h1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1zm0-14H6v1h4zm2 7v7h3V8zm-8 7V8H1v7z"/>
                </svg>
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <h2 class="card-title">Emergency numbers</h2>
                  <h6 class="card-subtitle mb-2 text-muted">Police, fire, and paramedic services</h6>
                </div>
              </div>

            </div>
          </div>

          <div class="card mb-3" role="button" id="safety-button">
            <div class="row g-0">
              <div class="col-md-4" style="padding: 20px">
                <!-- add container-defining element here -->
                <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="currentColor" class="bi bi-postcard-heart" viewBox="0 0 16 16">
                  <path d="M8 4.5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0zm3.5.878c1.482-1.42 4.795 1.392 0 4.622-4.795-3.23-1.482-6.043 0-4.622M2.5 5a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"/>
                  <path fill-rule="evenodd" d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1z"/>
                </svg>
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <h2 class="card-title">General Safety</h2>
                  <h6 class="card-subtitle mb-2 text-muted">Customs and courtesies to increase safety while traveling</h6>

                </div>
              </div>

            </div>
          </div>
        </div>
      <!-- end home-page section -->


      <div class="hidden element-blurb" id="emergency-numbers-blurb">
        <div class="planet-image">
          <!-- <img
            src="/images/alekhine.png"
            alt="A depiction of the planet Alekhine, produced by SXDL 1.0"
          /> -->
        </div>
         <div class="section-info">  <!-- planet-info -->
          <h2>Emergency Numbers</h2>
          <p>
            this is a silly little test of the emergency numbers system
          </p>
        </div>
      </div>

      <div class="hidden element-blurb" id="safety-blurb">
        <div class="planet-image">
          <!-- <img
            src="/images/alekhine.png"
            alt="A depiction of the planet Alekhine, produced by SXDL 1.0"
          /> -->
        </div>
         <div class="section-info">  <!-- planet-info -->
          <h2>General Safety</h2>
          <p>
            gosh isn't this so silly?
          </p>
        </div>
      </div>


    </div>
  </body>
  <script>
    ///////// Active navbar logic /////////
    // Get the current page URL
    var currentPageUrl = window.location.href;

    // Get all nav links
    var navLinks = document.querySelectorAll('nav a');

    // Loop through each nav link
    navLinks.forEach(function(navLink) {
      // Check if the href attribute of the nav link matches the current page URL
      if (navLink.href === currentPageUrl) {
        // If it matches, add the 'active' class to the nav link
        navLink.classList.add('active');
      }
    });
    /////////  /////////  /////////  /////////

    ///////// Hide and show sections logic /////////
    const blurbElements = {
      Emergency: document.getElementById("emergency-numbers-blurb"),
      Safety: document.getElementById("safety-blurb")
    };

    

    const navigateToBlurb = (sectionName) => {
        if (!blurbElements[sectionName]) {
          throw new Error(`No blurb found for ${sectionName} section`);
        }

        for (const [name, blurbElement] of Object.entries(blurbElements)) {
          if (name === sectionName) {
            blurbElement.classList.remove("hidden");
          } else {
            blurbElement.classList.add("hidden");
          }
        }
        document.getElementById("home-page").classList.add("hidden");
        document.getElementById("home-button").classList.remove("hidden");

        
      };

    document
        .getElementById("emergency-numbers-button")
        .addEventListener("click", () => {
          navigateToBlurb("Emergency");
          
        });

    document
        .getElementById("safety-button")
        .addEventListener("click", () => {
          navigateToBlurb("Safety");
          
        });

      ////// home functionality

      const navigateHome = () => {
        for (const blurbElement of Object.values(blurbElements)) {
          blurbElement.classList.add("hidden");
        }

        document.getElementById("home-page").classList.remove("hidden");
        document.getElementById("home-button").classList.add("hidden");
      };
      
      document.getElementById("home-button").addEventListener("click", () => {
        navigateHome();
      });




      // LOGIC FOR GEOLOCATION!!!!!
      // structure from https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch 
      document.getElementById("location-text").innerHTML = "<p style=\"font-style: italic;\">Fetching location..."
        
      if ("geolocation" in navigator) {
        /* geolocation is available */
        navigator.geolocation.getCurrentPosition((position) => {
          const userLatitude = position.coords.latitude;
          const userLongitude = position.coords.longitude;
          console.log("User's Lat & Long: [" + userLatitude + ", " + userLongitude + "]");
          // getNumbers(userLatitude, userLongitude);
          responseLoaded(userLatitude, userLongitude);
          // for now, change class of loaders & location when obtaining coordinates; real implementation will do this after fetching response
        });
      } else {
        /* geolocation IS NOT available, assign defaults of the geographical center of the USA [39.8283° N, 98.5795° W] */
        const userLatitude = 39.8283;
        const userLongitude = 98.5795;
        console.log("Default Lat & Long used (geographical center of the USA): [" + userLatitude + ", " + userLongitude + "]");
        // getNumbers(userLatitude, userLongitude);
        responseLoaded(userLatitude, userLongitude);
      }

      // AI smart call, commented to save tokens (use example response to help format!)
      //
      // async function getNumbers(lat, lon) {
      //   const latLongString = lat + ", " + lon;
      //   console.log(latLongString);
      //   const response = await fetch(
      //     'https://noggin.rea.gent/exceptional-stingray-1544',
      //     {
      //       method: 'POST',
      //       headers: {
      //         'Content-Type': 'application/json',
      //         Authorization: 'Bearer rg_v1_9tkx496eqkm1zwop5h9ss0o28w3qrgo7nb8o_ngk',
      //       },
      //       body: JSON.stringify({
      //         // fill variables here.
      //         "coordinates": latLongString,
      //       }),
      //     }
      //   ).then(response => response.text());
      //   console.log(response);
      //   }

      // response to first working call = 
          //{
          //   "location": {
          //     "city": "Oakland",
          //     "state": "California",
          //     "country": "United States"
          //   },
          //   "emergency_numbers": {
          //     "police": "911",
          //     "fire_department": "911",
          //     "emergency_services": "911"
          //   },
          //   "nearest_embassy": {
          //     "address": "U.S. Consulate General, 1 Sansome Street, Suite 850, San Francisco, CA 94104"
          //   }
          // }
          // 

          const exampleResponse = {
              "location": {
                "city": "Oakland",
                "state": "California",
                "country": "United States"
              },
              "emergency_numbers": {
                "police": "911",
                "fire_department": "911",
                "emergency_services": "911"
              },
              "nearest_embassy": {
                "address": "U.S. Consulate General, 1 Sansome Street, Suite 850, San Francisco, CA 94104"
              }
            };
          console.log(exampleResponse);

          function responseLoaded(lat, long) { // leave room for real response var in func
            console.log("called responseLoaded");
            document.getElementById("dot-loader").classList.add("hidden");
            document.getElementById("location-display").classList.remove("hidden");

            // document.getElementById("h").classList.add("hidden");
            document.getElementById("location-display").innerHTML = "<p>" + exampleResponse.location.city + ", " + exampleResponse.location.state;

          }
          
  </script>
</html>
